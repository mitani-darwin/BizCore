あなたは Rails 8 と 業務システム向けSaaS（マルチテナント・RBAC）に精通したエンジニアです。
既存プロジェクトに 監査ログ（Audit Log / Activity Log）機能を実装してください。

⸻

ゴール
	•	管理画面で行われた操作を 必ず記録
	•	誰が / いつ / どこで / 何をしたか を後から追跡できる
	•	権限トラブル・誤操作・内部不正に対して説明責任を果たせる
	•	実装が侵食的にならず、今後の拡張（業務操作/API）にも耐える

⸻

監査ログの対象範囲（必須）

記録する操作
	•	/admin 配下で行われた以下の操作
	•	create
	•	update
	•	destroy
	•	index / show は 最初は記録しなくてよい（将来拡張余地は残す）

記録対象リソース（最低限）
	•	tenants
	•	users
	•	roles
	•	permissions
	•	assignments（user-role 割当）

⸻

データ設計（必須）

audit_logs テーブル

以下のような構成を想定してください（必要に応じて調整可）：
	•	id
	•	tenant_id（null 不可）
	•	user_id（操作したユーザー、null 可 ※ system 操作用）
	•	action（string）
	•	例：create, update, destroy
	•	auditable_type（string）
	•	例：User, Role
	•	auditable_id（integer）
	•	summary（string）
	•	人間が一目で分かる要約（例：「ユーザーを更新」）
	•	changes（jsonb / json）
	•	before / after が分かる差分（update 時）
	•	ip_address（string）
	•	user_agent（string）
	•	created_at

制約・方針：
	•	削除されない（論理削除もしない）
	•	tenant 境界を必ず守る
	•	書き込み専用（update/delete しない）

⸻

実装方針（重要）

1) Controller Hook 方式（推奨）
	•	Admin::BaseController に共通の audit hook を仕込む
	•	after_action で create/update/destroy を検知
	•	成功時のみ記録（例外時は記録しない）

2) 情報取得
	•	user：Current.user
	•	tenant：Current.tenant
	•	IP / User-Agent：request.remote_ip, request.user_agent
	•	操作対象：
	•	controller から @resource（例：@user, @role）を拾う設計にする
	•	命名規則をドキュメント化

3) 差分（changes）の扱い
	•	update 時のみ記録
	•	ActiveRecord の saved_changes などを利用
	•	セキュリティ上不要なカラム（password 等）は除外

⸻

管理画面（閲覧UI）

Audit Log 一覧画面
	•	/admin/audit_logs
	•	表示項目：
	•	日時
	•	操作ユーザー
	•	操作内容（summary）
	•	対象リソース
	•	IP
	•	TailwindCSS 4.1 でシンプルに
	•	ページネーション（kaminari / pagy 等、仮でOK）

詳細画面（余力があれば）
	•	before / after の差分を JSON で表示

権限制御
	•	閲覧には admin.audit_logs.index 権限が必要
	•	サイドバーには 権限がある場合のみ表示

⸻

Seed（必須）
	•	Permission seed に以下を追加
	•	admin.audit_logs.index
	•	admin.audit_logs.show（詳細を作る場合）
	•	built_in role（owner/admin）には自動付与

⸻

実装要件まとめ
	•	マルチテナント対応（tenant_id 必須）
	•	冪等・安全（失敗しても本処理を壊さない）
	•	ログ記録失敗時は 例外を握り潰し、処理は続行
	•	「あとから直せない設計」にならないこと

⸻

出力形式（必須）
	•	追加/変更するファイルを ファイルパス付きで列挙
	•	各ファイルの 全文コード
	•	migration を含める
	•	audit hook の流れを 簡単な箇条書き or コメントで説明
	•	動作確認手順（例：ユーザー更新 → audit_logs に記録される）

⸻

受け入れ条件
	•	管理画面で create/update/destroy を行うと audit_logs に必ず1件残る
	•	他テナントのログは見えない
	•	権限がないユーザーは監査ログ画面に入れない
	•	監査ログが原因で通常の業務処理が失敗しない

⸻

この仕様に従って、Rails 8 のコードを実装してください。